<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bigasan POS System</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="stylesheet" href="css/styles.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>

  <!-- ===== LOGIN SCREEN ===== -->
  <div id="login-screen">

    <!-- Decorative rings -->
    <div class="ll-ring ll-ring-1"></div>
    <div class="ll-ring ll-ring-2"></div>
    <div class="ll-ring ll-ring-3"></div>

    <span id="brand-login-title" style="display:none"></span>

    <!-- LEFT: Branding panel -->
    <div class="lc-left">

      <div class="lc-logo-wrap">
        <div class="lc-logo-ring"></div>
        <img src="assets/logo.jpg" alt="Bigasan ni Joshua" />
      </div>

      <!-- <div class="lc-brand-name">Bigasan ni Joshua</div>
      <div class="lc-brand-sub">Point of Sale System &mdash; Owner Portal</div> -->

      <!-- Features -->
      <div class="lc-features">
        <div class="lc-feat"><i class="fa-solid fa-seedling"></i><span>Farm Fresh Rice</span></div>
        <div class="lc-feat-sep"></div>
        <div class="lc-feat"><i class="fa-solid fa-shield-halved"></i><span>Trusted Quality</span></div>
        <div class="lc-feat-sep"></div>
        <div class="lc-feat"><i class="fa-solid fa-bolt"></i><span>Fast Checkout</span></div>
      </div>

      <!-- Stats -->
      <div class="lc-stats">
        <div class="lc-stat"><div class="lc-stat-val">100%</div><div class="lc-stat-lbl">Natural Rice</div></div>
        <div class="lc-stat-sep"></div>
        <div class="lc-stat"><div class="lc-stat-val">Daily</div><div class="lc-stat-lbl">Fresh Stock</div></div>
        <div class="lc-stat-sep"></div>
        <div class="lc-stat"><div class="lc-stat-val">Local</div><div class="lc-stat-lbl">Sourced Grains</div></div>
      </div>

      <!-- Module pills -->
      <div class="lc-modules">
        <span class="lc-mod"><i class="fa-solid fa-gauge-high"></i> Dashboard</span>
        <span class="lc-mod"><i class="fa-solid fa-cash-register"></i> POS</span>
        <span class="lc-mod"><i class="fa-solid fa-boxes-stacked"></i> Inventory</span>
        <span class="lc-mod"><i class="fa-solid fa-chart-line"></i> Reports</span>
        <span class="lc-mod"><i class="fa-solid fa-users"></i> Customers</span>
        <span class="lc-mod"><i class="fa-solid fa-truck"></i> Suppliers</span>
      </div>

      <div class="lc-footer">&copy; 2026 Bigasan ni Joshua &mdash; All rights reserved.</div>

    </div>

    <!-- Vertical separator -->
    <div class="lc-sep"></div>

    <!-- RIGHT: Form panel -->
    <div class="lc-right">

      <div class="lc-form-inner">

        <div class="lc-welcome-icon"><i class="fa-solid fa-bowl-rice"></i></div>
        <h2 class="login-welcome">Welcome back!</h2>
        <p class="login-welcome-sub">Enter your credentials to access your store dashboard and manage all operations.</p>

        <div class="lc-divider">
          <span class="lc-div-line"></span>
          <span class="lc-div-label"><i class="fa-solid fa-lock"></i> Secure Sign In</span>
          <span class="lc-div-line"></span>
        </div>

        <div id="login-error" class="login-error" style="display:none">
          <i class="fa-solid fa-circle-exclamation"></i>
          <span>Incorrect username or password. Please try again.</span>
        </div>

        <div class="form-group login-field">
          <label for="login-username">Username</label>
          <div class="login-input-wrap">
            <i class="fa-solid fa-user login-input-icon"></i>
            <input type="text" id="login-username" placeholder="Enter your username" autocomplete="username" />
          </div>
        </div>

        <div class="form-group login-field">
          <label for="login-password">Password</label>
          <div class="login-input-wrap">
            <i class="fa-solid fa-lock login-input-icon"></i>
            <input type="password" id="login-password" placeholder="Enter your password" autocomplete="current-password" />
            <button type="button" id="login-eye" class="pw-eye" tabindex="-1"><i class="fa-solid fa-eye"></i></button>
          </div>
        </div>

        <div class="login-options-row">
          <label class="remember-label">
            <input type="checkbox" id="login-remember" />
            <span>Remember me</span>
          </label>
          <a href="#" class="forgot-link">Forgot password?</a>
        </div>

        <button class="btn-login" id="login-btn">
          <i class="fa-solid fa-right-to-bracket"></i> Sign In
        </button>

        <div class="lc-or-divider">
          <span class="lc-div-line"></span>
          <span class="lc-div-label" style="font-size:.78rem;color:var(--text-muted,#94a3b8);padding:0 10px">OR</span>
          <span class="lc-div-line"></span>
        </div>

        <button class="btn-google" id="google-login-btn" type="button">
          <svg class="google-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
            <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
            <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66-2.84z" fill="#FBBC05"/>
            <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
          </svg>
          <span>Continue with Google</span>
        </button>

        <p id="google-login-error" class="login-error" style="display:none;margin-top:10px">
          <i class="fa-solid fa-circle-exclamation"></i>
          <span id="google-login-error-msg">Google sign-in failed. Please try again.</span>
        </p>

      </div>

    </div>

  </div>

  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar" style="display:none">
    <div class="sidebar-brand">
      <img src="assets/logo.jpg" alt="Bigasan POS Logo" class="brand-logo" />
      <span id="brand-sidebar-name" title="Click to edit store name">Bigasan ni Joshua</span>
    </div>
    <nav class="sidebar-nav">
      <div class="sidebar-nav-section">Overview</div>
      <a class="nav-item active" data-view="dashboard"><i class="fa-solid fa-gauge-high"></i><span>Dashboard</span></a>
      <div class="sidebar-nav-section">Operations</div>
      <a class="nav-item" data-view="pos"><i class="fa-solid fa-cash-register"></i><span>Point of Sale</span></a>
      <a class="nav-item" data-view="inventory"><i class="fa-solid fa-boxes-stacked"></i><span>Inventory</span></a>
      <a class="nav-item" data-view="reports"><i class="fa-solid fa-chart-line"></i><span>Reports</span></a>
      <div class="sidebar-nav-section">People</div>
      <a class="nav-item" data-view="customers"><i class="fa-solid fa-users"></i><span>Customers</span></a>
      <a class="nav-item" data-view="credits"><i class="fa-solid fa-hand-holding-dollar"></i><span>Credits</span></a>
      <a class="nav-item" data-view="suppliers"><i class="fa-solid fa-truck"></i><span>Suppliers</span></a>
    </nav>
    <div class="sidebar-clock" id="sidebar-clock"></div>    <div id="cloud-sync-indicator" style="font-size:.75rem;padding:6px 16px 4px;display:flex;align-items:center;gap:6px;color:var(--sidebar-text);opacity:.7"></div>    <button class="sidebar-settings-btn" id="open-settings-btn" title="Settings & Backup">
      <i class="fa-solid fa-gear"></i><span>Settings &amp; Backup</span>
    </button>
    <button class="sidebar-settings-btn" id="logout-btn" title="Log Out" style="color:#f87171">
      <i class="fa-solid fa-right-from-bracket"></i><span>Log Out</span>
    </button>
  </aside>

  <!-- Main -->
  <main class="main-content" style="display:none">

    <!-- ===== TOPBAR ===== -->
    <div class="topbar" id="main-topbar">
      <div class="topbar-left">
        <div class="topbar-breadcrumb">
          <span class="topbar-page-icon" id="topbar-page-icon"><i class="fa-solid fa-gauge-high"></i></span>
          <i class="fa-solid fa-chevron-right topbar-chevron"></i>
          <span class="topbar-page-title" id="topbar-page-title">Dashboard</span>
        </div>
      </div>
      <div class="topbar-right">
        <div class="topbar-status-pill">
          <span class="topbar-status-dot"></span>
          <span>System Online</span>
        </div>
        <div class="topbar-time-block" id="topbar-time-display"></div>
        <div class="topbar-divider-v"></div>
        <div class="topbar-user-chip">
          <div class="topbar-avatar"><i class="fa-solid fa-user-tie"></i></div>
          <div class="topbar-user-info">
            <span class="topbar-username" id="topbar-username">Owner</span>
            <span class="topbar-role">Administrator</span>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== DASHBOARD ===== -->
    <section class="view active" id="view-dashboard">
      <div class="view-header">
        <h1><i class="fa-solid fa-gauge-high"></i> Dashboard</h1>
        <span id="dash-date" class="subtitle"></span>
      </div>

      <!-- Welcome Banner -->
      <div class="dash-welcome-banner">
        <div class="dwb-content">
          <div class="dwb-tag"><i class="fa-solid fa-bolt"></i> Live Overview</div>
          <div class="dwb-greeting" id="dwb-greeting">Good morning!</div>
          <div class="dwb-sub">Here's a snapshot of your store's performance today.</div>
          <div class="dwb-badges">
            <span class="dwb-badge"><i class="fa-solid fa-circle-check"></i> All systems operational</span>
            <span class="dwb-badge"><i class="fa-solid fa-shield-halved"></i> Data secured</span>
          </div>
        </div>
        <div class="dwb-graphic">
          <div class="dwb-ring dwb-ring-1"></div>
          <div class="dwb-ring dwb-ring-2"></div>
          <div class="dwb-icon-wrap"><i class="fa-solid fa-bowl-rice"></i></div>
        </div>
      </div>

      <div class="stat-cards">
        <div class="stat-card blue">
          <div class="stat-icon"><i class="fa-solid fa-peso-sign"></i></div>
          <div class="stat-info"><div class="stat-value" id="dash-today">₱0.00</div><div class="stat-label">Today's Sales</div></div>
        </div>
        <div class="stat-card green">
          <div class="stat-icon"><i class="fa-solid fa-receipt"></i></div>
          <div class="stat-info"><div class="stat-value" id="dash-txn">0</div><div class="stat-label">Transactions Today</div></div>
        </div>
        <div class="stat-card orange">
          <div class="stat-icon"><i class="fa-solid fa-triangle-exclamation"></i></div>
          <div class="stat-info"><div class="stat-value" id="dash-low">0</div><div class="stat-label">Low Stock Items</div></div>
        </div>
        <div class="stat-card purple">
          <div class="stat-icon"><i class="fa-solid fa-calendar-days"></i></div>
          <div class="stat-info"><div class="stat-value" id="dash-month">₱0.00</div><div class="stat-label">Monthly Sales</div></div>
        </div>
        <div class="stat-card red">
          <div class="stat-icon"><i class="fa-solid fa-hand-holding-dollar"></i></div>
          <div class="stat-info"><div class="stat-value" id="dash-credits">₱0.00</div><div class="stat-label">Outstanding Credits</div></div>
        </div>
      </div>
      <div class="two-col">
        <div class="panel">
          <div class="panel-header"><h2>Sales – Last 7 Days</h2></div>
          <div class="chart-wrap"><canvas id="dashSalesChart"></canvas></div>
        </div>
        <div class="panel">
          <div class="panel-header"><h2>Top Products</h2></div>
          <div id="top-products"></div>
        </div>
      </div>
      <div class="panel mt">
        <div class="panel-header"><h2>Recent Transactions</h2></div>
        <div class="tbl-wrap">
          <table class="tbl">
            <thead><tr><th>Receipt #</th><th>Date & Time</th><th>Customer</th><th>Items</th><th>Total</th><th>Payment</th></tr></thead>
            <tbody id="dash-txn-table"></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- ===== POS ===== -->
    <section class="view" id="view-pos">
      <div class="pos-layout">
        <!-- Left: Products -->
        <div class="pos-left">
          <div class="pos-topbar">
            <div class="search-box">
              <i class="fa-solid fa-search"></i>
              <input type="text" id="pos-search" placeholder="Search rice products…" />
            </div>
            <div class="pos-filters" id="pos-filters">
              <button class="flt active" data-filter="all">All</button>
              <button class="flt" data-filter="kilo">Per Kilo</button>
              <button class="flt" data-filter="sack">Sack</button>
              <button class="flt" data-filter="prepacked">Pre-packed</button>
            </div>
          </div>
          <div class="product-grid" id="product-grid"></div>
        </div>
        <!-- Right: Cart -->
        <div class="pos-right">
          <div class="cart-head">
            <h2><i class="fa-solid fa-cart-shopping"></i> Cart</h2>
            <select id="cart-customer" class="customer-select">
              <option value="">Walk-in Customer</option>
            </select>
          </div>
          <div class="cart-list" id="cart-list">
            <div class="cart-empty"><i class="fa-solid fa-cart-shopping"></i><p>Cart is empty</p></div>
          </div>
          <div class="cart-footer">
            <div class="cart-row"><span>Subtotal</span><span id="cart-subtotal">₱0.00</span></div>
            <div class="cart-row">
              <span>Discount (₱)</span>
              <input type="number" id="cart-discount" value="0" min="0" class="discount-inp" />
            </div>
            <div class="cart-row total"><span>TOTAL</span><span id="cart-total">₱0.00</span></div>
            <div class="pay-methods">
              <label>Payment</label>
              <div class="pay-btns">
                <button class="pay-btn active" data-method="cash"><i class="fa-solid fa-money-bills"></i> Cash</button>
                <button class="pay-btn" data-method="gcash"><i class="fa-solid fa-mobile-screen"></i> GCash</button>
                <button class="pay-btn" data-method="credit"><i class="fa-solid fa-file-invoice"></i> Credit</button>
              </div>
            </div>
            <div id="cash-section">
              <label>Cash Tendered</label>
              <input type="number" id="cash-tendered" placeholder="0.00" min="0" class="cash-inp" />
              <div class="change-row">Change: <strong id="change-display">₱0.00</strong></div>
            </div>
            <div class="cart-actions">
              <button class="btn btn-danger" id="clear-cart"><i class="fa-solid fa-trash"></i> Clear</button>
              <button class="btn btn-primary" id="checkout-btn"><i class="fa-solid fa-check"></i> Checkout</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== INVENTORY ===== -->
    <section class="view" id="view-inventory">
      <div class="view-header">
        <h1><i class="fa-solid fa-boxes-stacked"></i> Inventory</h1>
        <button class="btn btn-primary" id="inv-add-btn"><i class="fa-solid fa-plus"></i> Add Product</button>
      </div>
      <div class="filter-bar">
        <input type="text" id="inv-search" placeholder="Search products…" class="search-inp" />
        <select id="inv-type-filter">
          <option value="all">All Types</option>
          <option value="kilo">Per Kilo</option>
          <option value="sack">Sack</option>
          <option value="prepacked">Pre-packed</option>
        </select>
      </div>
      <div class="tbl-wrap">
        <table class="tbl">
          <thead>
            <tr><th>Product Name</th><th>Type</th><th>Price</th><th>Unit</th><th>Stock</th><th>Low Stock Alert</th><th>Status</th><th>Actions</th></tr>
          </thead>
          <tbody id="inv-table"></tbody>
        </table>
      </div>
    </section>

    <!-- ===== REPORTS ===== -->
    <section class="view" id="view-reports">
      <div class="view-header">
        <h1><i class="fa-solid fa-chart-line"></i> Sales Reports</h1>
        <div class="report-controls">
          <select id="report-period">
            <option value="today">Today</option>
            <option value="week" selected>This Week</option>
            <option value="month">This Month</option>
            <option value="custom">Custom Range</option>
          </select>
          <div id="custom-range" style="display:none;gap:6px;align-items:center;display:none">
            <input type="date" id="report-from" />
            <span>to</span>
            <input type="date" id="report-to" />
            <button class="btn btn-secondary btn-sm" id="apply-range">Apply</button>
          </div>
          <button class="btn btn-secondary" id="export-csv"><i class="fa-solid fa-file-csv"></i> Export CSV</button>
        </div>
      </div>
      <div class="stat-cards">
        <div class="stat-card blue"><div class="stat-icon"><i class="fa-solid fa-peso-sign"></i></div><div class="stat-info"><div class="stat-value" id="rep-total">₱0.00</div><div class="stat-label">Total Sales</div></div></div>
        <div class="stat-card green"><div class="stat-icon"><i class="fa-solid fa-receipt"></i></div><div class="stat-info"><div class="stat-value" id="rep-txn">0</div><div class="stat-label">Transactions</div></div></div>
        <div class="stat-card orange"><div class="stat-icon"><i class="fa-solid fa-calculator"></i></div><div class="stat-info"><div class="stat-value" id="rep-avg">₱0.00</div><div class="stat-label">Avg. per Transaction</div></div></div>
        <div class="stat-card purple"><div class="stat-icon"><i class="fa-solid fa-tag"></i></div><div class="stat-info"><div class="stat-value" id="rep-disc">₱0.00</div><div class="stat-label">Total Discounts</div></div></div>
      </div>
      <div class="two-col">
        <div class="panel"><div class="panel-header"><h2>Sales Trend</h2></div><div class="chart-wrap"><canvas id="repTrendChart"></canvas></div></div>
        <div class="panel"><div class="panel-header"><h2>Sales by Product</h2></div><div class="chart-wrap"><canvas id="repProdChart"></canvas></div></div>
      </div>
      <div class="panel mt">
        <div class="panel-header"><h2>Transactions</h2></div>
        <div class="tbl-wrap">
          <table class="tbl">
            <thead><tr><th>Receipt #</th><th>Date & Time</th><th>Customer</th><th>Items</th><th>Discount</th><th>Total</th><th>Payment</th><th>Actions</th></tr></thead>
            <tbody id="rep-txn-table"></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- ===== CUSTOMERS ===== -->
    <section class="view" id="view-customers">
      <div class="view-header">
        <h1><i class="fa-solid fa-users"></i> Customers</h1>
        <button class="btn btn-primary" id="cust-add-btn"><i class="fa-solid fa-plus"></i> Add Customer</button>
      </div>
      <div class="filter-bar">
        <input type="text" id="cust-search" placeholder="Search customers…" class="search-inp" />
      </div>
      <div class="tbl-wrap">
        <table class="tbl">
          <thead><tr><th>Name</th><th>Phone</th><th>Address</th><th>Purchases</th><th>Total Spent</th><th>Credit Balance</th><th>Last Purchase</th><th>Actions</th></tr></thead>
          <tbody id="cust-table"></tbody>
        </table>
      </div>
    </section>

    <!-- ===== CREDITS ===== -->
    <section class="view" id="view-credits">
      <div class="view-header">
        <h1><i class="fa-solid fa-hand-holding-dollar"></i> Credit Ledger</h1>
        <div class="report-controls">
          <select id="credit-status-filter">
            <option value="all">All Credits</option>
            <option value="active">Active</option>
            <option value="overdue">Overdue</option>
            <option value="paid">Paid</option>
          </select>
        </div>
      </div>
      <div class="stat-cards">
        <div class="stat-card red">
          <div class="stat-icon"><i class="fa-solid fa-peso-sign"></i></div>
          <div class="stat-info"><div class="stat-value" id="cr-outstanding">₱0.00</div><div class="stat-label">Total Outstanding</div></div>
        </div>
        <div class="stat-card orange">
          <div class="stat-icon"><i class="fa-solid fa-triangle-exclamation"></i></div>
          <div class="stat-info"><div class="stat-value" id="cr-overdue">₱0.00</div><div class="stat-label">Overdue Amount</div></div>
        </div>
        <div class="stat-card blue">
          <div class="stat-icon"><i class="fa-solid fa-clock"></i></div>
          <div class="stat-info"><div class="stat-value" id="cr-due-soon">0</div><div class="stat-label">Due Within 3 Days</div></div>
        </div>
        <div class="stat-card green">
          <div class="stat-icon"><i class="fa-solid fa-circle-check"></i></div>
          <div class="stat-info"><div class="stat-value" id="cr-paid-month">₱0.00</div><div class="stat-label">Collected This Month</div></div>
        </div>
      </div>
      <div class="filter-bar">
        <input type="text" id="credit-search" placeholder="Search by customer or receipt…" class="search-inp" />
      </div>
      <div class="tbl-wrap">
        <table class="tbl">
          <thead>
            <tr>
              <th>Receipt #</th>
              <th>Customer</th>
              <th>Purchase Date</th>
              <th>Due Date</th>
              <th>Total Amount</th>
              <th>Amount Paid</th>
              <th>Balance</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="credit-table"></tbody>
        </table>
      </div>
    </section>

    <!-- ===== SUPPLIERS ===== -->
    <section class="view" id="view-suppliers">
      <div class="view-header">
        <h1><i class="fa-solid fa-truck"></i> Suppliers & Restocking</h1>
        <div style="display:flex;gap:8px">
          <button class="btn btn-secondary" id="restock-add-btn"><i class="fa-solid fa-plus"></i> Add Restock</button>
          <button class="btn btn-primary" id="sup-add-btn"><i class="fa-solid fa-plus"></i> Add Supplier</button>
        </div>
      </div>
      <div class="two-col">
        <div class="panel">
          <div class="panel-header"><h2>Suppliers</h2></div>
          <div class="tbl-wrap">
            <table class="tbl">
              <thead><tr><th>Name</th><th>Contact</th><th>Address</th><th>Actions</th></tr></thead>
              <tbody id="sup-table"></tbody>
            </table>
          </div>
        </div>
        <div class="panel">
          <div class="panel-header"><h2>Restock History</h2></div>
          <div class="tbl-wrap">
            <table class="tbl">
              <thead><tr><th>Date</th><th>Product</th><th>Supplier</th><th>Qty Added</th><th>Cost</th></tr></thead>
              <tbody id="restock-table"></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

  </main>

  <!-- ============ MODALS ============ -->

  <!-- Kilo/Qty Entry Modal -->
  <div class="modal-overlay" id="qty-modal">
    <div class="modal sm">
      <div class="modal-header"><h3 id="qty-modal-title">Enter Quantity</h3><button class="modal-close" data-close="qty-modal">×</button></div>
      <div class="modal-body">
        <p id="qty-product-name" class="modal-product-name"></p>
        <label id="qty-label">Weight (kg)</label>
        <input type="number" id="qty-input" placeholder="0.00" min="0.01" step="0.01" class="modal-input big-input" />
        <p class="price-preview">Price: <strong id="qty-price-preview">₱0.00</strong></p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-close="qty-modal">Cancel</button>
        <button class="btn btn-primary" id="qty-confirm">Add to Cart</button>
      </div>
    </div>
  </div>

  <!-- Receipt Modal -->
  <div class="modal-overlay" id="receipt-modal">
    <div class="modal">
      <div class="modal-header"><h3>Receipt</h3><button class="modal-close" data-close="receipt-modal">×</button></div>
      <div class="modal-body">
        <div id="receipt-content"></div>
      </div>
      <div class="modal-footer no-print">
        <button class="btn btn-secondary" data-close="receipt-modal">Close</button>
        <button class="btn btn-primary" id="print-receipt"><i class="fa-solid fa-print"></i> Print</button>
      </div>
    </div>
  </div>

  <!-- Product Modal (Add/Edit) -->
  <div class="modal-overlay" id="product-modal">
    <div class="modal">
      <div class="modal-header"><h3 id="prod-modal-title">Add Product</h3><button class="modal-close" data-close="product-modal">×</button></div>
      <div class="modal-body">
        <input type="hidden" id="prod-id" />
        <div class="form-row">
          <div class="form-group">
            <label>Product Name *</label>
            <input type="text" id="prod-name" placeholder="e.g. Sinandomeng" />
          </div>
          <div class="form-group">
            <label>Type *</label>
            <select id="prod-type">
              <option value="kilo">Per Kilo</option>
              <option value="sack">Sack</option>
              <option value="prepacked">Pre-packed</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Price (₱) *</label>
            <input type="number" id="prod-price" placeholder="0.00" min="0" step="0.01" />
          </div>
          <div class="form-group">
            <label>Unit Label *</label>
            <input type="text" id="prod-unit" placeholder="e.g. kg, sack, 5kg bag" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Current Stock *</label>
            <input type="number" id="prod-stock" placeholder="0" min="0" step="0.01" />
          </div>
          <div class="form-group">
            <label>Low Stock Alert</label>
            <input type="number" id="prod-low" placeholder="10" min="0" />
          </div>
        </div>
        <div class="form-group">
          <label>Description (optional)</label>
          <input type="text" id="prod-desc" placeholder="Additional notes" />
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-close="product-modal">Cancel</button>
        <button class="btn btn-primary" id="prod-save">Save Product</button>
      </div>
    </div>
  </div>

  <!-- Customer Modal -->
  <div class="modal-overlay" id="customer-modal">
    <div class="modal">
      <div class="modal-header"><h3 id="cust-modal-title">Add Customer</h3><button class="modal-close" data-close="customer-modal">×</button></div>
      <div class="modal-body">
        <input type="hidden" id="cust-id" />
        <div class="form-row">
          <div class="form-group">
            <label>Full Name *</label>
            <input type="text" id="cust-name" placeholder="Juan dela Cruz" />
          </div>
          <div class="form-group">
            <label>Phone</label>
            <input type="text" id="cust-phone" placeholder="09xxxxxxxxx" />
          </div>
        </div>
        <div class="form-group">
          <label>Address</label>
          <input type="text" id="cust-address" placeholder="Barangay, City" />
        </div>
        <div class="form-group">
          <label>Notes</label>
          <input type="text" id="cust-notes" placeholder="Optional notes" />
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-close="customer-modal">Cancel</button>
        <button class="btn btn-primary" id="cust-save">Save Customer</button>
      </div>
    </div>
  </div>

  <div class="modal-overlay" id="cust-history-modal">
    <div class="modal lg">
      <div class="modal-header"><h3 id="cust-history-title">Purchase History</h3><button class="modal-close" data-close="cust-history-modal">×</button></div>
      <div class="modal-body">
        <div class="tbl-wrap"><table class="tbl"><thead><tr><th>Receipt #</th><th>Date</th><th>Items</th><th>Total</th><th>Payment</th></tr></thead><tbody id="cust-history-table"></tbody></table></div>
        <div id="cust-credit-section" style="margin-top:18px">
          <h4 style="margin:0 0 8px;color:var(--primary)">Credit Records</h4>
          <div class="tbl-wrap"><table class="tbl"><thead><tr><th>Receipt #</th><th>Due Date</th><th>Total</th><th>Paid</th><th>Balance</th><th>Status</th></tr></thead><tbody id="cust-credit-table"></tbody></table></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Supplier Modal -->
  <div class="modal-overlay" id="supplier-modal">
    <div class="modal">
      <div class="modal-header"><h3 id="sup-modal-title">Add Supplier</h3><button class="modal-close" data-close="supplier-modal">×</button></div>
      <div class="modal-body">
        <input type="hidden" id="sup-id" />
        <div class="form-row">
          <div class="form-group">
            <label>Supplier Name *</label>
            <input type="text" id="sup-name" placeholder="Rice Supplier Co." />
          </div>
          <div class="form-group">
            <label>Contact Number</label>
            <input type="text" id="sup-contact" placeholder="09xxxxxxxxx" />
          </div>
        </div>
        <div class="form-group">
          <label>Address</label>
          <input type="text" id="sup-address" placeholder="City, Province" />
        </div>
        <div class="form-group">
          <label>Notes</label>
          <input type="text" id="sup-notes" placeholder="Optional notes" />
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-close="supplier-modal">Cancel</button>
        <button class="btn btn-primary" id="sup-save">Save Supplier</button>
      </div>
    </div>
  </div>

  <!-- Restock Modal -->
  <div class="modal-overlay" id="restock-modal">
    <div class="modal">
      <div class="modal-header"><h3>Add Restock</h3><button class="modal-close" data-close="restock-modal">×</button></div>
      <div class="modal-body">
        <div class="form-row">
          <div class="form-group">
            <label>Product *</label>
            <select id="restock-product"></select>
          </div>
          <div class="form-group">
            <label>Supplier (optional)</label>
            <select id="restock-supplier"><option value="">None</option></select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Quantity Added *</label>
            <input type="number" id="restock-qty" placeholder="0" min="0.01" step="0.01" />
          </div>
          <div class="form-group">
            <label>Total Cost (₱)</label>
            <input type="number" id="restock-cost" placeholder="0.00" min="0" step="0.01" />
          </div>
        </div>
        <div class="form-group">
          <label>Date</label>
          <input type="date" id="restock-date" />
        </div>
        <div class="form-group">
          <label>Notes</label>
          <input type="text" id="restock-notes" placeholder="Optional notes" />
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-close="restock-modal">Cancel</button>
        <button class="btn btn-primary" id="restock-save">Save Restock</button>
      </div>
    </div>
  </div>

  <!-- Settings & Backup Modal -->
  <div class="modal-overlay" id="settings-modal">
    <div class="modal" style="max-width:520px">
      <div class="modal-header">
        <h3><i class="fa-solid fa-gear"></i> Settings &amp; Backup</h3>
        <button class="modal-close" data-close="settings-modal">×</button>
      </div>
      <div class="modal-body">
        <!-- Store Info -->
        <h4 style="margin:0 0 10px;color:var(--primary)">Store Information</h4>
        <div class="form-group">
          <label>Store Name</label>
          <input type="text" id="set-store-name" placeholder="Store Name" />
        </div>
        <div class="form-group">
          <label>Address</label>
          <input type="text" id="set-address" placeholder="Address" />
        </div>
        <div class="form-group">
          <label>Phone</label>
          <input type="text" id="set-phone" placeholder="Phone number" />
        </div>
        <div class="form-group">
          <label>Receipt Note</label>
          <input type="text" id="set-receipt-note" placeholder="e.g. Thank you for your purchase!" />
        </div>

        <!-- Backup & Restore -->
        <hr style="margin:18px 0;border-color:var(--border)" />
        <h4 style="margin:0 0 6px;color:var(--primary)">Backup &amp; Restore Data</h4>
        <p style="margin:0 0 12px;font-size:.85rem;color:var(--text-secondary)">Export saves <strong>all</strong> data (products, sales history, customers, suppliers) to a JSON file you can keep. Import that file on any device or after any redeployment to restore everything.</p>
        <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:12px">
          <button class="btn btn-secondary" id="backup-export-btn"><i class="fa-solid fa-download"></i> Export Backup (.json)</button>
          <label class="btn btn-secondary" style="cursor:pointer" title="Select a backup JSON file">
            <i class="fa-solid fa-upload"></i> Import Backup
            <input type="file" id="backup-import-input" accept=".json" style="display:none" />
          </label>
        </div>

        <!-- Change Password -->
        <hr style="margin:18px 0;border-color:var(--border)" />
        <h4 style="margin:0 0 10px;color:var(--primary)">Change Owner Credentials</h4>
        <div class="form-row">
          <div class="form-group">
            <label>Username</label>
            <input type="text" id="set-owner-username" placeholder="Username" autocomplete="off" />
          </div>
          <div class="form-group">
            <label>New Password</label>
            <input type="password" id="set-owner-password" placeholder="New password" autocomplete="new-password" />
          </div>
        </div>
        <div class="form-group" style="max-width:250px">
          <label>Confirm Password</label>
          <input type="password" id="set-owner-confirm" placeholder="Confirm new password" autocomplete="new-password" />
        </div>
        <button class="btn btn-secondary" id="change-pw-btn" style="margin-top:4px"><i class="fa-solid fa-key"></i> Update Credentials</button>

        <!-- Danger Zone -->
        <hr style="margin:18px 0;border-color:#fca5a5" />
        <h4 style="margin:0 0 6px;color:#dc2626">Danger Zone</h4>
        <p style="margin:0 0 10px;font-size:.85rem;color:var(--text-secondary)">Permanently deletes <strong>all</strong> sales history and resets the app. Export a backup first!</p>
        <button class="btn btn-danger" id="clear-all-data-btn"><i class="fa-solid fa-trash"></i> Clear All Data</button>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-close="settings-modal">Cancel</button>
        <button class="btn btn-primary" id="settings-save-btn">Save Settings</button>
      </div>
    </div>
  </div>

  <!-- Transaction Detail Modal -->
  <div class="modal-overlay" id="txn-detail-modal">
    <div class="modal">
      <div class="modal-header"><h3 id="txn-detail-title">Transaction Detail</h3><button class="modal-close" data-close="txn-detail-modal">×</button></div>
      <div class="modal-body" id="txn-detail-body"></div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-close="txn-detail-modal">Close</button>
        <button class="btn btn-primary" id="txn-reprint">Reprint Receipt</button>
      </div>
    </div>
  </div>

  <!-- Credit Payment Modal -->
  <div class="modal-overlay" id="credit-payment-modal">
    <div class="modal sm">
      <div class="modal-header">
        <h3><i class="fa-solid fa-hand-holding-dollar"></i> Record Payment</h3>
        <button class="modal-close" data-close="credit-payment-modal">×</button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="cp-credit-id" />
        <div class="credit-summary-box" id="cp-summary"></div>
        <div class="form-group" style="margin-top:14px">
          <label>Payment Amount (₱) *</label>
          <input type="number" id="cp-amount" placeholder="0.00" min="0.01" step="0.01" class="modal-input big-input" />
        </div>
        <div class="form-group">
          <label>Note (optional)</label>
          <input type="text" id="cp-note" placeholder="e.g. Partial payment" />
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-close="credit-payment-modal">Cancel</button>
        <button class="btn btn-primary" id="cp-save"><i class="fa-solid fa-check"></i> Record Payment</button>
      </div>
    </div>
  </div>

  <!-- Credit Detail Modal -->
  <div class="modal-overlay" id="credit-detail-modal">
    <div class="modal lg">
      <div class="modal-header">
        <h3 id="credit-detail-title">Credit Detail</h3>
        <button class="modal-close" data-close="credit-detail-modal">×</button>
      </div>
      <div class="modal-body" id="credit-detail-body"></div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-close="credit-detail-modal">Close</button>
      </div>
    </div>
  </div>

  <!-- Toast notification -->
  <div id="toast-container"></div>

  <!-- Single ES-module entry — Vite bundles firebase + zustand + all JS -->
  <script type="module" src="/js/app.js"></script>
</body>
</html>
